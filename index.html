import tkinter as tk
from tkinter import messagebox
import datetime
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.application import MIMEApplication
import os

# Configurações básicas
EMAIL_DESTINO = "diego.pereira1508@gmail.com"
TAXAS_HORA = {
    "Elétrica": 103.00,
    "Manutenção civil": 97.00,
    "Hidraulica": 97.50
}

# Função para enviar e-mail
def enviar_email(arquivo):
    msg = MIMEMultipart()
    msg['From'] = 'seuemail@gmail.com'
    msg['To'] = EMAIL_DESTINO
    msg['Subject'] = 'Registro de Ponto Diário'

    corpo = "Segue em anexo o registro de ponto do dia."
    msg.attach(MIMEText(corpo, 'plain'))

    with open(arquivo, "rb") as f:
        parte = MIMEApplication(f.read(), Name=os.path.basename(arquivo))
    parte['Content-Disposition'] = f'attachment; filename="{os.path.basename(arquivo)}"'
    msg.attach(parte)

    try:
        server = smtplib.SMTP('smtp.gmail.com', 587)
        server.starttls()
        server.login('seuemail@gmail.com', 'suasenha')
        server.send_message(msg)
        server.quit()
        messagebox.showinfo("Sucesso", "Registro enviado por e-mail.")
    except Exception as e:
        messagebox.showerror("Erro", f"Erro ao enviar e-mail: {str(e)}")

# Função para salvar e enviar PDF
def salvar_e_enviar_pdf(registros):
    hoje = datetime.datetime.now().strftime("%Y-%m-%d")
    nome_pdf = f"registro_ponto_{hoje}.pdf"

    with open(nome_pdf, "w") as f:
        f.write("Registro de Ponto - Diário\n")
        for reg in registros:
            f.write(f"{reg[0]} | {reg[1]} | {reg[2]} | {reg[3]}\n")

    enviar_email(nome_pdf)
    os.startfile(nome_pdf)

# Função principal da aplicação
def iniciar_aplicacao():
    registros = []

    def registrar_entrada():
        agora = datetime.datetime.now().strftime("%Y-%m-%d %H:%M")
        funcao = funcao_var.get()
        registros.append([agora, funcao, "", ""])
        atualizar_lista()

    def registrar_saida():
        if not registros or registros[-1][2] != "":
            messagebox.showwarning("Erro", "Não há entrada pendente!")
            return

        agora = datetime.datetime.now().strftime("%Y-%m-%d %H:%M")
        registros[-1][2] = agora

        entrada = datetime.datetime.strptime(registros[-1][0], "%Y-%m-%d %H:%M")
        saida = datetime.datetime.strptime(registros[-1][2], "%Y-%m-%d %H:%M")
        minutos_trabalhados = (saida - entrada).seconds // 60
        valor_hora = TAXAS_HORA[registros[-1][1]]
        valor_trabalhado = (minutos_trabalhados / 60) * valor_hora

        registros[-1][3] = f"R$ {valor_trabalhado:.2f}"
        atualizar_lista()
        salvar_e_enviar_pdf(registros)

    def atualizar_lista():
        lista_registros.delete(0, tk.END)
        for reg in registros:
            lista_registros.insert(tk.END, f"{reg[0]} | {reg[1]} | {reg[2]} | {reg[3]}")

    # Configuração da janela principal
    janela = tk.Tk()
    janela.title("Registro de Ponto")
    janela.geometry("500x400")

    tk.Label(janela, text="Função:").pack()
    funcao_var = tk.StringVar(value="Elétrica")
    tk.OptionMenu(janela, funcao_var, "Elétrica", "Manutenção civil", "Hidraulica").pack()

    tk.Button(janela, text="Registrar Entrada", command=registrar_entrada).pack(pady=5)
    tk.Button(janela, text="Registrar Saída", command=registrar_saida).pack(pady=5)

    lista_registros = tk.Listbox(janela, width=70, height=15)
    lista_registros.pack(pady=10)

    tk.Button(janela, text="Sair", command=janela.destroy).pack(pady=5)

    janela.mainloop()

# Iniciar a aplicação
if __name__ == "__main__":
    iniciar_aplicacao()<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSP Contabilidade - Declaração do IRPF 2025</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Cabeçalho com Logo e Menu -->
    <header>
        <div class="container">
            <div class="logo">
                <img src="https://via.placeholder.com/150x50.png?text=RSP+Contabilidade" alt="Logo RSP Contabilidade">
            </div>
            <nav>
                <ul>
                    <li><a href="#servicos">Serviços</a>
                        <ul class="submenu">
                            <li><a href="#abertura-empresa">Abertura de Empresa</a></li>
                            <li><a href="#declaracao-ir">Declaração de Imposto de Renda</a></li>
                            <li><a href="#abertura-mei">Abertura MEI</a></li>
                            <li><a href="#declaracao-mei">Declaração MEI</a></li>
                            <li><a href="#fechamento-empresas">Fechamento de Empresas</a></li>
                        </ul>
                    </li>
                    <li><a href="https://wa.me/5551998258820?text=Olá,%20gostaria%20de%20mais%20informações%20sobre%20os%20serviços%20da%20RSP%20Contabilidade" target="_blank">Contato: (51) 99825-8820</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Conteúdo Principal -->
    <main class="container">
        <section>
            <h2>Quem Deve Declarar o IRPF em 2025?</h2>
            <p>A obrigatoriedade de declarar o Imposto de Renda depende dos rendimentos recebidos em 2024. Confira os critérios:</p>
            <h3>Limites para 2025:</h3>
            <ul>
                <li><strong>Rendimentos tributáveis:</strong> Acima de R$ 33.888,00</li>
                <li><strong>Receita bruta da atividade rural:</strong> Acima de R$ 169.440,00</li>
                <li><strong>Bens e direitos (valor total):</strong> Acima de R$ 500.000,00</li>
                <li><strong>Rendimentos isentos/não tributáveis:</strong> Acima de R$ 40.000,00</li>
            </ul>
            <h3>Outros Critérios de Obrigatoriedade:</h3>
            <ul>
                <li>Possuir bens ou direitos acima de R$ 500.000,00.</li>
                <li>Ter tido ganho de capital na venda de bens ou direitos.</li>
                <li>Ter recebido rendimentos isentos, não tributáveis ou tributados na fonte acima de R$ 40.000,00.</li>
                <li>Ter residido no exterior e recebido rendimentos no Brasil.</li>
            </ul>
            <p><strong>Observação:</strong> Mesmo que não seja obrigatório, você pode optar por declarar para obter restituição ou compensar prejuízos.</p>
        </section>

        <section>
            <h2>Calendário de Restituições do IRPF 2024</h2>
            <p>A Receita Federal libera a restituição do Imposto de Renda em lotes. Confira as datas:</p>
            <table>
                <thead>
                    <tr>
                        <th>Lote</th>
                        <th>Data de Pagamento</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Primeiro lote</td>
                        <td>30 de maio de 2024</td>
                    </tr>
                    <tr>
                        <td>Segundo lote</td>
                        <td>30 de junho de 2024</td>
                    </tr>
                    <tr>
                        <td>Terceiro lote</td>
                        <td>31 de julho de 2024</td>
                    </tr>
                    <tr>
                        <td>Quarto lote</td>
                        <td>29 de agosto de 2024</td>
                    </tr>
                </tbody>
            </table>
            <h3>Quem Recebe Primeiro?</h3>
            <p>A prioridade para receber a restituição segue a ordem estabelecida pela Receita Federal:</p>
            <ol>
                <li><strong>Primeiro Grupo:</strong> Idosos acima de 80 anos, pessoas com deficiência física ou mental, e pessoas com doenças graves.</li>
                <li><strong>Segundo Grupo:</strong> Contribuintes com idade entre 60 e 79 anos.</li>
                <li><strong>Terceiro Grupo:</strong> Professores que tenham rendimentos provenientes exclusivamente da atividade de magistério.</li>
                <li><strong>Quarto Grupo:</strong> Demais contribuintes, conforme a ordem de entrega da declaração.</li>
            </ol>
            <p><strong>Dica:</strong> Envie sua declaração o mais cedo possível para aumentar suas chances de receber a restituição nos primeiros lotes.</p>
        </section>
    </main>

    <!-- Rodapé -->
    <footer>
        <div class="container">
            <h3>Precisa de Ajuda?</h3>
            <p>Entre em contato conosco via WhatsApp para mais informações:</p>
            <a href="https://wa.me/5551998258820?text=Olá,%20gostaria%20de%20mais%20informações%20sobre%20os%20serviços%20da%20RSP%20Contabilidade" class="whatsapp-button" target="_blank">
                <i class="fab fa-whatsapp"></i> Enviar Mensagem
            </a>
        </div>
    </footer>
</body>
</html>
